<script>
  const targetEl = document.querySelector('#target');
  const overlay = document.querySelector('#scanning-overlay');
  const dino = document.querySelector('#dino');
  const toggleBtn = document.querySelector('#toggleMode');

  targetEl.addEventListener("targetFound", () => { overlay.classList.add("hidden"); });
  targetEl.addEventListener("targetLost", () => { overlay.classList.remove("hidden"); });

  let isVertical = false;

  toggleBtn.addEventListener('click', () => {
    isVertical = !isVertical;
    
    if (isVertical) {
      // STANDING UP (Wall Mode)
      // If 90 was flat on the wall, 0 should be standing straight up toward the user.
      dino.setAttribute('rotation', '0 0 0'); 
      dino.setAttribute('position', '0 0.1 0'); // Lowered because it's standing now
      toggleBtn.innerText = "Switch to Flat";
    } else {
      // LAYING DOWN (Table Mode)
      // This is the "Wall" look you described earlier.
      dino.setAttribute('rotation', '90 0 0');
      dino.setAttribute('position', '0 0.5 0'); // Raised slightly so it sits on the paper
      toggleBtn.innerText = "Switch to Vertical";
    }
  });

  dino.addEventListener('model-loaded', () => {
    const mesh = dino.getObject3D('mesh');
    mesh.traverse((node) => {
      if (node.isMesh) {
        node.material.metalness = 0;
        node.material.roughness = 1;
      }
    });
  });
</script>
